size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates,
aes(x = 21.5, y = prop_surviving, label = significance),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
legend       <- c('    0', ' 0.5','    1','    5','  10','  50','100','500')
significance <- c('    0   -  a', ' 0.5   -  ab','    1   -  ab','    5   -  a','  10   -  ab','  50   -  ab','100*  -  b','500*  -  c')
line_types <- c("solid", "dashed", "dotted", "dotdash", "longdash", "twodash", "solid", "twodash")
{surv_plot <- survfit(Surv(time = survival, event = censor) ~ 1 + concentration, data = plot_data)
surv_plot <- ggsurvplot(surv_plot, data = exp1_data,
censor = FALSE,
legend.title = 'Concentration [ppm]',
legend.labs = legend,
legend = c(0.15, 0.25),
xlab = 'Time (days)',
ylab = 'Proportion Surviving',
# break.time.by = 2,
xlim = c(0, 24),
ylim = c(0, 1),
ggtheme = theme_bw(),
palette = viridis(8, begin = 0, end = 0.9, option = 5),
conf.int = TRUE,
conf.int.alpha = 0.1,
linetype = line_types,
size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates,
aes(x = 21.5, y = prop_surviving, label = significance),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
dash <- rep("-", 8)
dash
y_coordinates
prop_surviving
significance
significance[1:6]
y_coordinates <- exp1_data %>%
group_by(concentration) %>%
summarize(prop_surviving = sum(censor==0) / n()) %>% as.data.frame()
plot_data <- exp1_data %>% mutate(survival = ifelse(survival == 20 & censor == 0, 20.5, survival))
legend       <- c('    0', ' 0.5','    1','    5','  10','  50','100','500')
significance <- c('    0   -  a', ' 0.5   -  ab','    1   -  ab','    5   -  a','  10   -  ab','  50   -  ab','100*  -  b','500*  -  c')
dash <- rep("-", 8)
line_types <- c("solid", "dashed", "dotted", "dotdash", "longdash", "twodash", "solid", "twodash")
{surv_plot <- survfit(Surv(time = survival, event = censor) ~ 1 + concentration, data = plot_data)
surv_plot <- ggsurvplot(surv_plot, data = exp1_data,
censor = FALSE,
legend.title = 'Concentration [ppm]',
legend.labs = legend,
legend = c(0.15, 0.25),
xlab = 'Time (days)',
ylab = 'Proportion Surviving',
# break.time.by = 2,
xlim = c(0, 24),
ylim = c(0, 1),
ggtheme = theme_bw(),
palette = viridis(8, begin = 0, end = 0.9, option = 5),
conf.int = TRUE,
conf.int.alpha = 0.1,
linetype = line_types,
size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates[1:6, ],
aes(x = 21.5, y = prop_surviving, label = significance[1:6]),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates[7:8, ],
aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
fontface = "bold") +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
y_coordinates
y_coordinates <- exp1_data %>%
group_by(concentration) %>%
summarize(prop_surviving = sum(censor==0) / n()) %>% as.data.frame()
plot_data <- exp1_data %>% mutate(survival = ifelse(survival == 20 & censor == 0, 20.5, survival))
legend       <- c('    0', ' 0.5','    1','    5','  10','  50','100','500')
significance <- c('    0   -  a', ' 0.5   -  ab','    1   -  ab','    5   -  a','  10   -  ab','  50   -  ab','100*  -  b','500*  -  c')
dash             <- rep("-", 8)
significance_2   <- c('a','ab','ab','a','ab','ab','b','c')
treatment_labels <- c('0','0.5','1','5','10','50','100*','500*')
line_types       <- c("solid", "dashed", "dotted", "dotdash", "longdash", "twodash", "solid", "twodash")
{surv_plot <- survfit(Surv(time = survival, event = censor) ~ 1 + concentration, data = plot_data)
surv_plot <- ggsurvplot(surv_plot, data = exp1_data,
censor = FALSE,
legend.title = 'Concentration [ppm]',
legend.labs = legend,
legend = c(0.15, 0.25),
xlab = 'Time (days)',
ylab = 'Proportion Surviving',
# break.time.by = 2,
xlim = c(0, 24),
ylim = c(0, 1),
ggtheme = theme_bw(),
palette = viridis(8, begin = 0, end = 0.9, option = 5),
conf.int = TRUE,
conf.int.alpha = 0.1,
linetype = line_types,
size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates,
aes(x = 22.5, y = prop_surviving, label = dash),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
# geom_text(data = y_coordinates[1:6, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[1:6]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
{surv_plot <- survfit(Surv(time = survival, event = censor) ~ 1 + concentration, data = plot_data)
surv_plot <- ggsurvplot(surv_plot, data = exp1_data,
censor = FALSE,
legend.title = 'Concentration [ppm]',
legend.labs = legend,
legend = c(0.15, 0.25),
xlab = 'Time (days)',
ylab = 'Proportion Surviving',
# break.time.by = 2,
xlim = c(0, 24),
ylim = c(0, 1),
ggtheme = theme_bw(),
palette = viridis(8, begin = 0, end = 0.9, option = 5),
conf.int = TRUE,
conf.int.alpha = 0.1,
linetype = line_types,
size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates,
aes(x = 23, y = prop_surviving, label = dash),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates,
aes(x = 23, y = prop_surviving, label = significance_2),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
# geom_text(data = y_coordinates[1:6, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[1:6]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
{surv_plot <- survfit(Surv(time = survival, event = censor) ~ 1 + concentration, data = plot_data)
surv_plot <- ggsurvplot(surv_plot, data = exp1_data,
censor = FALSE,
legend.title = 'Concentration [ppm]',
legend.labs = legend,
legend = c(0.15, 0.25),
xlab = 'Time (days)',
ylab = 'Proportion Surviving',
# break.time.by = 2,
xlim = c(0, 24),
ylim = c(0, 1),
ggtheme = theme_bw(),
palette = viridis(8, begin = 0, end = 0.9, option = 5),
conf.int = TRUE,
conf.int.alpha = 0.1,
linetype = line_types,
size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates,
aes(x = 23, y = prop_surviving, label = dash),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates,
aes(x = 23.5 , y = prop_surviving, label = significance_2),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
# geom_text(data = y_coordinates[1:6, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[1:6]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
{surv_plot <- survfit(Surv(time = survival, event = censor) ~ 1 + concentration, data = plot_data)
surv_plot <- ggsurvplot(surv_plot, data = exp1_data,
censor = FALSE,
legend.title = 'Concentration [ppm]',
legend.labs = legend,
legend = c(0.15, 0.25),
xlab = 'Time (days)',
ylab = 'Proportion Surviving',
# break.time.by = 2,
xlim = c(0, 24),
ylim = c(0, 1),
ggtheme = theme_bw(),
palette = viridis(8, begin = 0, end = 0.9, option = 5),
conf.int = TRUE,
conf.int.alpha = 0.1,
linetype = line_types,
size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates,
aes(x = 23, y = prop_surviving, label = dash),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates,
aes(x = 23.5 , y = prop_surviving, label = significance_2),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates,
aes(x = 21.5, y = prop_surviving, label = treatment_labels),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
fontface = "bold") +
# geom_text(data = y_coordinates[1:6, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[1:6]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
{surv_plot <- survfit(Surv(time = survival, event = censor) ~ 1 + concentration, data = plot_data)
surv_plot <- ggsurvplot(surv_plot, data = exp1_data,
censor = FALSE,
legend.title = 'Concentration [ppm]',
legend.labs = legend,
legend = c(0.15, 0.25),
xlab = 'Time (days)',
ylab = 'Proportion Surviving',
# break.time.by = 2,
xlim = c(0, 24),
ylim = c(0, 1),
ggtheme = theme_bw(),
palette = viridis(8, begin = 0, end = 0.9, option = 5),
conf.int = TRUE,
conf.int.alpha = 0.1,
linetype = line_types,
size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates,
aes(x = 23, y = prop_surviving, label = dash),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates,
aes(x = 23.5 , y = prop_surviving, label = significance_2),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates[1:6, ],
aes(x = 21.5, y = prop_surviving, label = treatment_labels[1:6, ]),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
fontface = "bold") +
geom_text(data = y_coordinates[7:8, ],
aes(x = 21.5, y = prop_surviving, label = treatment_labels[7:8, ]),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
fontface = "bold") +
# geom_text(data = y_coordinates[1:6, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[1:6]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
{surv_plot <- survfit(Surv(time = survival, event = censor) ~ 1 + concentration, data = plot_data)
surv_plot <- ggsurvplot(surv_plot, data = exp1_data,
censor = FALSE,
legend.title = 'Concentration [ppm]',
legend.labs = legend,
legend = c(0.15, 0.25),
xlab = 'Time (days)',
ylab = 'Proportion Surviving',
# break.time.by = 2,
xlim = c(0, 24),
ylim = c(0, 1),
ggtheme = theme_bw(),
palette = viridis(8, begin = 0, end = 0.9, option = 5),
conf.int = TRUE,
conf.int.alpha = 0.1,
linetype = line_types,
size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates,
aes(x = 23, y = prop_surviving, label = dash),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates,
aes(x = 23.5 , y = prop_surviving, label = significance_2),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates[1:6, ],
aes(x = 21.5, y = prop_surviving, label = treatment_labels[1:6]),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
fontface = "bold") +
geom_text(data = y_coordinates[7:8, ],
aes(x = 21.5, y = prop_surviving, label = treatment_labels[7:8]),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
fontface = "bold") +
# geom_text(data = y_coordinates[1:6, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[1:6]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
{surv_plot <- survfit(Surv(time = survival, event = censor) ~ 1 + concentration, data = plot_data)
surv_plot <- ggsurvplot(surv_plot, data = exp1_data,
censor = FALSE,
legend.title = 'Concentration [ppm]',
legend.labs = legend,
legend = c(0.15, 0.25),
xlab = 'Time (days)',
ylab = 'Proportion Surviving',
# break.time.by = 2,
xlim = c(0, 24),
ylim = c(0, 1),
ggtheme = theme_bw(),
palette = viridis(8, begin = 0, end = 0.9, option = 5),
conf.int = TRUE,
conf.int.alpha = 0.1,
linetype = line_types,
size = 0.8,
alpha = 0.8)
surv_plot$plot <- surv_plot$plot +
theme(panel.grid = element_blank()) +
theme(
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.ticks = element_line(linewidth = 0.8),
strip.text = element_text(size = 10),
legend.key.width = unit(2, "line"),
legend.position = "none") +
scale_x_continuous(breaks = seq(0, 20, by = 2)) +
scale_y_continuous(
breaks = seq(0.25, 1, by = 0.15),
limits = c(0.16, 1)) +
geom_text(data = y_coordinates,
aes(x = 23, y = prop_surviving, label = dash),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates,
aes(x = 23.5 , y = prop_surviving, label = significance_2),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates[1:6, ],
aes(x = 21.5, y = prop_surviving, label = treatment_labels[1:6]),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
geom_text(data = y_coordinates[7:8, ],
aes(x = 21.5, y = prop_surviving, label = treatment_labels[7:8]),
size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
fontface = "bold") +
# geom_text(data = y_coordinates[1:6, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[1:6]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE) +
# geom_text(data = y_coordinates[7:8, ],
#           aes(x = 21.5, y = prop_surviving, label = significance[7:8]),
#           size = 3.5, hjust = 0, vjust = 0.5, inherit.aes = FALSE,
#           fontface = "bold") +
annotate("text", x = 20.75, y = 0.97, label = "c [ppm]", size = 3.5, hjust = 0, fontface = "bold")
surv_plot
}
