library(gridExtra)
grid.arrange(surv_ggplot, hazard_plot, ncol = 2)
layout_mat <- rbind(c(1,1,2), c(1,1,2))
grid.arrange(surv_ggplot, hazard_plot, layout_matrix = layout_mat)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.5, ymin = 0.25, ymax = 0.38 - y_offset),
fill = NA, color = "black")
print(surv_plot)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.8, ymin = 0.2, ymax = 0.38 - y_offset),
fill = NA, color = "black")
print(surv_plot)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.8, ymin = 0.2, ymax = 0.38 - y_offset),
fill = NA, color = "black", lwd = 0.8)
print(surv_plot)
surv_plot <- ggsurvplot(surviplot, data = flugus_data,
pval = FALSE,
linetype = line_types,
lwd = 1,
xlab = 'Time (days)', ylab = 'Proportion Surviving',
palette = color_vector,
ggtheme = theme_bw(),
xlim = c(0, 14), break.time.by = 2,
censor = FALSE,
conf.int = TRUE,
conf.int.alpha = 0.2,
legend = c(0.4, 0.25),
legend.title = "Treatments"
)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.8, ymin = 0.2, ymax = 0.38 - y_offset),
fill = NA, color = "black", lwd = 0.8)
print(surv_plot)
# Hazard plot for M. brunneum in dependence of pesticide concentration
# Plot the data
hazard_plot <- ggplot(hr_data, aes(x = Treatment, y = HR)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black", width = 0.8) + # Bars for HR with black borders
geom_errorbar(aes(ymin = HR_lo, ymax = HR_hi), width = 0.05, lwd = 1.2) + # Error bars for confidence intervals
labs(y = "Hazard Ratio (HR)",
x = "Flupyradifurone concentration") +
theme_bw() +
theme(panel.grid = element_blank(), legend.position = "none",
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
coord_cartesian(ylim=c(1,5.5))  # Setting y-axis limit to start from 1
print(hazard_plot)
print(surv_plot)
surv_plot <- ggsurvplot(surviplot, data = flugus_data,
pval = FALSE,
linetype = line_types,
lwd = 1,
xlab = 'Time (days)', ylab = 'Proportion Surviving',
palette = color_vector,
ggtheme = theme_bw(),
xlim = c(0, 14), break.time.by = 2,
censor = FALSE,
conf.int = TRUE,
conf.int.alpha = 0.2,
legend = c(0.4, 0.25),
legend.title = "Treatments"
)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.8, ymin = 0.2, ymax = 0.38 - y_offset),
fill = NA, color = "black", lwd = 0.8)
print(surv_plot)
surv_plot <- ggsurvplot(surviplot, data = flugus_data,
pval = FALSE,
linetype = line_types,
lwd = 1,
xlab = 'Time (days)', ylab = 'Proportion Surviving',
palette = color_vector,
ggtheme = theme_bw(),
xlim = c(0, 14), break.time.by = 2,
censor = FALSE,
conf.int = TRUE,
conf.int.alpha = 0.2,
legend = c(0.4, 0.25),
legend.title = "Treatments"
)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.8, ymin = 0.2, ymax = 0.38 - y_offset),
fill = NA, color = "black", lwd = 0.5)
print(surv_plot)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.8, ymin = 0.2, ymax = 0.38 - y_offset),
fill = NA, color = "black", lwd = 0.3)
print(surv_plot)
surv_ggplot <- surv_plot$plot
surv_plot <- ggsurvplot(surviplot, data = flugus_data,
pval = FALSE,
linetype = line_types,
lwd = 1,
xlab = 'Time (days)', ylab = 'Proportion Surviving',
palette = color_vector,
ggtheme = theme_bw(),
xlim = c(0, 14), break.time.by = 2,
censor = FALSE,
conf.int = TRUE,
conf.int.alpha = 0.2,
legend = c(0.4, 0.25),
legend.title = "Treatments"
)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.8, ymin = 0.2, ymax = 0.38 - y_offset),
fill = NA, color = "black", lwd = 0.3)
print(surv_plot)
surv_plot <- ggsurvplot(surviplot, data = flugus_data,
pval = FALSE,
linetype = line_types,
lwd = 1,
xlab = 'Time (days)', ylab = 'Proportion Surviving',
palette = color_vector,
ggtheme = theme_bw(),
xlim = c(0, 14), break.time.by = 2,
censor = FALSE,
conf.int = TRUE,
conf.int.alpha = 0.2,
legend = c(0.4, 0.25),
legend.title = "Treatments"
)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.8, ymin = 0.2, ymax = 0.38 - y_offset),
fill = NA, color = "black", lwd = 0.1)
print(surv_plot)
surv_plot <- ggsurvplot(surviplot, data = flugus_data,
pval = FALSE,
linetype = line_types,
lwd = 1,
xlab = 'Time (days)', ylab = 'Proportion Surviving',
palette = color_vector,
ggtheme = theme_bw(),
xlim = c(0, 14), break.time.by = 2,
censor = FALSE,
conf.int = TRUE,
conf.int.alpha = 0.2,
legend = c(0.4, 0.25),
legend.title = "Treatments"
)
surv_plot$plot <- surv_plot$plot +
scale_y_continuous(limits = c(0.2, 1), breaks = seq(0.2, 1, by = 0.2)) +
theme(panel.grid = element_blank(), legend.position = "none") +
theme(
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
# geom_segment(aes(x = 14.3, y = 0.78, xend = 14.3, yend = 0.65))+
# geom_segment(aes(x = 14.3, y = 0.52, xend = 14.3, yend = 0.325)) +
geom_segment(aes(x = 0.4, y = 0.33-y_offset, xend = 1, yend = 0.33-y_offset), color = chosen_colors[1], linetype = line_types[1]) +
geom_segment(aes(x = 0.4, y = 0.30-y_offset, xend = 1, yend = 0.30-y_offset), color = chosen_colors[1], linetype = line_types[3]) +
geom_segment(aes(x = 0.4, y = 0.271-y_offset, xend = 1, yend = 0.271-y_offset), color = chosen_colors[1], linetype = line_types[5]) +
geom_segment(aes(x = 1.5, y = 0.33-y_offset, xend = 2.1, yend = 0.33-y_offset), color = chosen_colors[2], linetype = line_types[1]) +
geom_segment(aes(x = 1.5, y = 0.30-y_offset, xend = 2.1, yend = 0.30-y_offset), color = chosen_colors[2], linetype = line_types[3]) +
geom_segment(aes(x = 1.5, y = 0.271-y_offset, xend = 2.1, yend = 0.271-y_offset), color = chosen_colors[2], linetype = line_types[5]) +
annotate("text", x = 0.3, y=0.36-y_offset, label="sham", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 1.3, y=0.36-y_offset, label="fungus", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.33-y_offset, label="0 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.30-y_offset, label="5 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
annotate("text", x = 2.5, y=0.27-y_offset, label="50 ppm", color = "black", size = 4, fontface = "plain", hjust = 0) +
geom_rect(aes(xmin = 0.2, xmax = 3.8, ymin = 0.2, ymax = 0.38 - y_offset),
fill = NA, color = "black", lwd = 0.05)
print(surv_plot)
surv_ggplot <- surv_plot$plot
# Hazard plot for M. brunneum in dependence of pesticide concentration
# Plot the data
hazard_plot <- ggplot(hr_data, aes(x = Treatment, y = HR)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black", width = 0.8) + # Bars for HR with black borders
geom_errorbar(aes(ymin = HR_lo, ymax = HR_hi), width = 0.05, lwd = 1.2) + # Error bars for confidence intervals
labs(y = "Hazard Ratio (HR)",
x = "Flupyradifurone concentration") +
theme_bw() +
theme(panel.grid = element_blank(), legend.position = "none",
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
coord_cartesian(ylim=c(1,5.5))  # Setting y-axis limit to start from 1
print(hazard_plot)
# Hazard plot for M. brunneum in dependence of pesticide concentration
hazard_plot <- ggplot(hr_data, aes(x = Treatment, y = HR)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black", width = 0.8) +
geom_errorbar(aes(ymin = HR_lo, ymax = HR_hi), width = 0.05, lwd = 1.2) + # Error bars for confidence intervals
labs(y = "Hazard Ratio (HR)",
x = "Flupyradifurone concentration") +
theme_bw() +
theme(panel.grid = element_blank(), legend.position = "none",
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
coord_cartesian(ylim=c(1,5.5))  # Setting y-axis limit to start from 1
print(hazard_plot)
# print the two plots together
grid.arrange(surv_ggplot, hazard_plot, ncol = 2)
# print the two plots together
layout_mat <- rbind(c(1,1,2), c(1,1,2))
grid.arrange(surv_ggplot, hazard_plot, layout_matrix = layout_mat)
# Hazard plot for M. brunneum in dependence of pesticide concentration
hazard_plot <- ggplot(hr_data, aes(x = Treatment, y = HR)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black", width = 0.8) +
geom_errorbar(aes(ymin = HR_lo, ymax = HR_hi), width = 0.1, lwd = 1.2) + # Error bars for confidence intervals
labs(y = "Hazard Ratio (HR)",
x = "Flupyradifurone concentration") +
theme_bw() +
theme(panel.grid = element_blank(), legend.position = "none",
axis.title = element_text(size = 14),
axis.text = element_text(size = 14),
axis.ticks = element_line(linewidth = 1),
strip.text = element_text(size = 14)) +
coord_cartesian(ylim=c(1,5.5))  # Setting y-axis limit to start from 1
print(hazard_plot)
grid.arrange(surv_ggplot, hazard_plot, layout_matrix = layout_mat)
# adjust variables and correct fluorescence by subtracting the mean values of blank ants.
supl_data$treatment <- as.factor(supl_data$treatment)
mean_negative_ant <- mean(supl_data$fluorescence[supl_data$sample_type == "negative_ant"])
for (i in 1:nrow(supl_data)) {
if (supl_data$fluorescence[i] >= mean_negative_ant) {
supl_data$fluorescence[i] <- supl_data$fluorescence[i] - mean_negative_ant
} else {
supl_data$fluorescence[i] <- 0
}
}
# for simlicity create two subsets, one containing only the standard curves and one containing the samples
# std curves
data_stdcurves <- subset(supl_data, supl_data$treatment == "std_curve", drop = TRUE)
data_stdcurves$treatment <- droplevels(data_stdcurves$treatment)
{
data_samples <- subset(supl_data, supl_data$sample_type == "ant")
data_samples$treatment <- droplevels(data_samples$treatment)
data_samples$treatment <- relevel(data_samples$treatment, "mid") # reorder the levels of the treatment variable
data_samples$treatment <- relevel(data_samples$treatment, "low")
data_samples$treatment <- relevel(data_samples$treatment, "control")
}
#### 4.2 Standard curve & calculation of food uptake (volume in μl) ####
# Plot the pooled standard curve
data_mean <- data_stdcurves %>%
group_by(concentration) %>%
summarise(mean_fluorescence = mean(fluorescence))
ggplot(data_mean, aes(x = concentration, y = mean_fluorescence)) +
geom_line() +
geom_smooth(method = "lm", se = FALSE, linewidth = 0.5) +
ggtitle("Mean Standard Curve with Linear Model Fit") +
xlab("Concentration [μl fluorescin / 100 μl sugar water]") +
ylab("Mean Fluorescence")
# get coeficients from linear model (forced through zero) to estimate how much food the ants consumed (based on the standard curves)
std_model <- lm(mean_fluorescence ~ 0 + concentration, data = data_mean)
coef <- coefficients(std_model)
slope <-  coef[[1]]
# calculate estimated volume of food uptake and add it to the dataframe
data_samples$consumed_volume <- data_samples$fluorescence / slope
#### 4.3 Food consumption stats ####
group_by(data_samples, treatment) %>%
summarise(
count = n(),
mean = mean(consumed_volume, na.rm = TRUE),
sd = sd(consumed_volume, na.rm = TRUE),
min = min(consumed_volume, na.rm = TRUE),
max = max(consumed_volume, na.rm = TRUE)
)
mod <- glmer.nb(consumed_volume ~ treatment + (1|petridish), data = data_samples)
summary(mod)
Anova(mod)
letters <- c("a", "b", "c", "d", "e", "f")
emmeans(mod, pairwise ~ "treatment", adjust = "tukey")
cld(emmeans(mod, pairwise ~ "treatment", adjust = "tukey"), Letters = letters)
cld(emmeans(mod, pairwise ~ "treatment", adjust = "tukey"), Letters = letters)
library(multcomp) # contains cld
install.packages("multcompView")
library(multcompView)
#### 4.2 Standard curve & calculation of food uptake (volume in μl) ####
# Plot the pooled standard curve
data_mean <- data_stdcurves %>%
group_by(concentration) %>%
summarise(mean_fluorescence = mean(fluorescence))
ggplot(data_mean, aes(x = concentration, y = mean_fluorescence)) +
geom_line() +
geom_smooth(method = "lm", se = FALSE, linewidth = 0.5) +
ggtitle("Mean Standard Curve with Linear Model Fit") +
xlab("Concentration [μl fluorescin / 100 μl sugar water]") +
ylab("Mean Fluorescence")
# get coeficients from linear model (forced through zero) to estimate how much food the ants consumed (based on the standard curves)
std_model <- lm(mean_fluorescence ~ 0 + concentration, data = data_mean)
coef <- coefficients(std_model)
slope <-  coef[[1]]
# calculate estimated volume of food uptake and add it to the dataframe
data_samples$consumed_volume <- data_samples$fluorescence / slope
#### 4.3 Food consumption stats ####
group_by(data_samples, treatment) %>%
summarise(
count = n(),
mean = mean(consumed_volume, na.rm = TRUE),
sd = sd(consumed_volume, na.rm = TRUE),
min = min(consumed_volume, na.rm = TRUE),
max = max(consumed_volume, na.rm = TRUE)
)
mod <- glmer.nb(consumed_volume ~ treatment + (1|petridish), data = data_samples)
summary(mod)
Anova(mod)
letters <- c("a", "b", "c", "d", "e", "f")
emmeans(mod, pairwise ~ "treatment", adjust = "tukey")
cld(emmeans(mod, pairwise ~ "treatment", adjust = "tukey"), Letters = letters)
residuals <- residuals(mod)
plot(residuals)
qqnorm(residuals)
qqline(residuals, col = "red")
# nice graph based on 0 intercept model exportet at 600x700
# Define the labels and their positions
labels_df <- data.frame(treatment = c("high", "mid", "control", "low"),
label = c("ab", "a", "ab", "b"))
# Plot with labels (exported as )
gg <- ggplot(data_samples, aes(x = treatment, y = consumed_volume)) +
geom_boxplot(fill = alpha("grey", 0.5), color = "black", notch = TRUE, outlier.shape = NA) +
geom_jitter(width = 0.2, height = 0, alpha = 0.2, color = viridis(1)[1]) +
labs(x = "Treatments", y = "Honey water consumption [μL]", title = "") +
theme(panel.background = element_rect(fill = "white", color = "black"),
panel.border = element_rect(color = "black", fill = NA),
axis.title = element_text(size = 15),
axis.text = element_text(size = 13)) +
coord_cartesian(ylim = c(0, 0.7))
label_positions <- ggplot_build(gg)$data[[1]]$x  # calculate position of x to put the letters right above the boxplots.
gg <- gg + geom_text(data = labels_df, aes(x = label_positions, y = 0.7, label = label, fontface = "bold"),
hjust = 0.5, vjust = 0.5, size = 5)
print(gg)
mod <- glmer.nb(consumed_volume ~ treatment + (1|petridish), data = data_samples)
summary(mod)
summary(mod)
Anova(mod)
letters <- c("a", "b", "c", "d", "e", "f")
emmeans(mod, pairwise ~ "treatment", adjust = "tukey")
